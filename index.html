<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: var(--tg-theme-bg-color, #ffffff);
            --text: var(--tg-theme-text-color, #000000);
            --hint: var(--tg-theme-hint-color, #999);
            --btn: var(--tg-theme-button-color, #2481cc);
            --btn-text: var(--tg-theme-button-text-color, #ffffff);
            --sec-bg: var(--tg-theme-secondary-bg-color, #f5f5f5);
        }

        body { font-family: -apple-system, sans-serif; background: var(--bg); color: var(--text); margin: 0; padding-bottom: 80px; }
        
        /* –®–∞–ø–∫–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π */
        .header { position: sticky; top: 0; background: var(--bg); z-index: 100; padding: 10px; border-bottom: 1px solid var(--sec-bg); }
        .scroll-menu { display: flex; overflow-x: auto; gap: 8px; scrollbar-width: none; padding-bottom: 5px; }
        .scroll-menu::-webkit-scrollbar { display: none; }
        .chip { background: var(--sec-bg); padding: 8px 14px; border-radius: 20px; font-size: 13px; white-space: nowrap; cursor: pointer; border: 1px solid transparent; }
        .chip.active { background: var(--btn); color: var(--btn-text); }

        /* –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ */
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; }
        .card { background: var(--sec-bg); border-radius: 12px; overflow: hidden; display: flex; flex-direction: column; }
        .card img { width: 100%; aspect-ratio: 1/1; object-fit: cover; }
        .info { padding: 10px; flex-grow: 1; }
        .title { font-size: 14px; font-weight: bold; margin-bottom: 4px; }
        .desc { font-size: 11px; color: var(--hint); margin-bottom: 8px; min-height: 26px; }
        .price { font-size: 16px; font-weight: 800; color: #31b545; }
        .add-btn { background: var(--btn); color: var(--btn-text); border: none; width: 100%; padding: 8px; border-radius: 8px; margin-top: 10px; font-weight: 600; }

        /* –û–∫–Ω–æ –∫–æ—Ä–∑–∏–Ω—ã */
        #cart-page { position: fixed; top: 0; left: 100%; width: 100%; height: 100%; background: var(--bg); z-index: 200; transition: 0.3s; padding: 20px; box-sizing: border-box; overflow-y: auto; }
        #cart-page.active { left: 0; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid var(--sec-bg); }
        .counter { display: flex; align-items: center; gap: 10px; }
        .count-btn { background: var(--sec-bg); border: none; width: 25px; height: 25px; border-radius: 5px; color: var(--text); }

        /* –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π */
        .section-title { font-size: 16px; font-weight: bold; margin: 20px 0 10px; }
        .delivery-grid { display: grid; grid-template-columns: 1fr; gap: 8px; }
        .d-btn { padding: 12px; border: 1px solid var(--btn); border-radius: 10px; background: none; color: var(--text); text-align: left; font-size: 14px; }
        .d-btn.active { background: var(--btn); color: var(--btn-text); }
        .hint-text { font-size: 12px; color: #e53935; margin-top: 10px; font-weight: bold; }
        textarea { width: 100%; padding: 10px; border-radius: 10px; border: 1px solid var(--hint); background: var(--bg); color: var(--text); box-sizing: border-box; }

        /* –§—É—Ç–µ—Ä */
        .footer { position: fixed; bottom: 0; width: 100%; padding: 15px; background: var(--bg); border-top: 1px solid var(--sec-bg); display: none; box-sizing: border-box; }
        .main-btn { background: var(--btn); color: var(--btn-text); border: none; width: 100%; padding: 14px; border-radius: 12px; font-size: 16px; font-weight: bold; }
    </style>
</head>
<body>

<div class="header">
    <div class="scroll-menu" id="cats">
        <div class="chip active" onclick="filter('all')">–í—Å–µ</div>
        <div class="chip" onclick="filter('mb')">üìü –ú–∞—Ç–µ—Ä–∏–Ω–∫–∏</div>
        <div class="chip" onclick="filter('cpu')">üíé –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã</div>
        <div class="chip" onclick="filter('ram')">üß† –ü–∞–º—è—Ç—å</div>
        <div class="chip" onclick="filter('cool')">–ö—É–ª–µ—Ä</div>
        <div class="chip" onclick="filter('psu')">–ë–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è</div>
        <div class="chip" onclick="filter('ssd')">SSD 2,5"</div>
        <div class="chip" onclick="filter('m2')">SSD M.2 NVME</div>
        <div class="chip" onclick="filter('case')">–ö–æ—Ä–ø—É—Å</div>
    </div>
    <div class="scroll-menu" style="margin-top: 8px;">
        <div class="chip" onclick="sort(1)">üìà –î–µ—à–µ–≤–ª–µ</div>
        <div class="chip" onclick="sort(-1)">üìâ –î–æ—Ä–æ–∂–µ</div>
    </div>
</div>

<div class="grid" id="products">
    <div class="card mb" data-price="7500">
        <img src="https://ae04.alicdn.com/kf/H215e96644f1c42268487779f64d0d34fG.jpg">
        <div class="info">
            <div class="title">Huananzhi X99-BD4</div>
            <div class="desc">4 –∫–∞–Ω–∞–ª–∞, –∞–∫—Ç–∏–≤–Ω—ã–π –æ–±–¥—É–≤ VRM</div>
            <div class="price">7500 ‚ÇΩ</div>
            <button class="add-btn" onclick="addToCart('X99-BD4', 7500)">–í –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
    </div>
    <div class="card cpu" data-price="1900">
        <img src="https://ae04.alicdn.com/kf/H946452240974415891465224376527.jpg">
        <div class="info">
            <div class="title">Xeon E5-2666 v3</div>
            <div class="desc">10 —è–¥–µ—Ä, 135W, –º–æ—â–Ω—ã–π CPU</div>
            <div class="price">1900 ‚ÇΩ</div>
            <button class="add-btn" onclick="addToCart('E5-2666 v3', 1900)">–í –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
    </div>
</div>

<div id="cart-page">
    <div onclick="toggleCart(false)" style="color: var(--btn); margin-bottom: 20px;">‚Üê –ù–∞–∑–∞–¥</div>
    <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
    <div id="cart-items"></div>

    <div class="section-title">–°–ø–æ—Å–æ–± –¥–æ—Å—Ç–∞–≤–∫–∏</div>
    <div class="delivery-grid">
        <button class="d-btn active" onclick="setD(this, '–°–∞–º–æ–≤—ã–≤–æ–∑')">üèÉ –°–∞–º–æ–≤—ã–≤–æ–∑</button>
        <button class="d-btn" onclick="setD(this, '–°–î–≠–ö')">üì¶ –°–î–≠–ö</button>
        <button class="d-btn" onclick="setD(this, '–Ø–Ω–¥–µ–∫—Å –ü–í–ó')">üíõ –Ø–Ω–¥–µ–∫—Å –ü–í–ó</button>
        <button class="d-btn" onclick="setD(this, '–Ø–Ω–¥–µ–∫—Å –ö—É—Ä—å–µ—Ä')">üö¥ –Ø–Ω–¥–µ–∫—Å –ö—É—Ä—å–µ—Ä</button>
    </div>
    <div class="hint-text">‚ö†Ô∏è –î–æ—Å—Ç–∞–≤–∫—É –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—å –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏.</div>

    <div class="section-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</div>
    <textarea id="order-comm" rows="3" placeholder="–í–∞—à–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è..."></textarea>

    <button class="main-btn" style="margin-top: 20px;" onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
</div>

<div class="footer" id="footer">
    <button class="main-btn" onclick="toggleCart(true)">–ö–æ—Ä–∑–∏–Ω–∞: <span id="f-total">0</span> ‚ÇΩ</button>
</div>

<script>
    let tg = window.Telegram.WebApp;
    tg.expand();
    let cart = {}; // –•—Ä–∞–Ω–∏–º –∫–∞–∫ { '–ù–∞–∑–≤–∞–Ω–∏–µ': {price: 100, count: 1} }
    let delivery = '–°–∞–º–æ–≤—ã–≤–æ–∑';

    function filter(c) {
        document.querySelectorAll('.chip').forEach(ch => ch.classList.remove('active'));
        event.target.classList.add('active');
        document.querySelectorAll('.card').forEach(card => {
            card.style.display = (c === 'all' || card.classList.contains(c)) ? 'flex' : 'none';
        });
    }

    function sort(dir) {
        let grid = document.getElementById('products');
        let cards = Array.from(grid.children);
        cards.sort((a, b) => (a.dataset.price - b.dataset.price) * dir);
        grid.innerHTML = '';
        cards.forEach(c => grid.appendChild(c));
    }

    function addToCart(name, price) {
        if (cart[name]) cart[name].count++;
        else cart[name] = { price: price, count: 1 };
        update();
        tg.HapticFeedback.impactOccurred('medium');
    }

    function changeCount(name, delta) {
        cart[name].count += delta;
        if (cart[name].count <= 0) delete cart[name];
        update();
        renderCart();
    }

    function update() {
        let total = 0;
        for (let id in cart) total += cart[id].price * cart[id].count;
        document.getElementById('f-total').innerText = total;
        document.getElementById('footer').style.display = total > 0 ? 'block' : 'none';
    }

    function toggleCart(st) {
        if(st) renderCart();
        document.getElementById('cart-page').classList.toggle('active', st);
    }

    function renderCart() {
        let h = '';
        for (let name in cart) {
            h += `<div class="cart-item">
                <div style="font-size:14px;">${name}<br><small>${cart[name].price}‚ÇΩ</small></div>
                <div class="counter">
                    <button class="count-btn" onclick="changeCount('${name}', -1)">-</button>
                    <span>${cart[name].count}</span>
                    <button class="count-btn" onclick="changeCount('${name}', 1)">+</button>
                </div>
            </div>`;
        }
        document.getElementById('cart-items').innerHTML = h || '–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞';
    }

    function setD(el, type) {
        document.querySelectorAll('.d-btn').forEach(b => b.classList.remove('active'));
        el.classList.add('active');
        delivery = type;
    }

    function checkout() {
        let comm = document.getElementById('order-comm').value;
        let total = 0;
        let text = `üöÄ –ù–û–í–´–ô –ó–ê–ö–ê–ó\n----------\n`;
        for (let name in cart) {
            text += `‚Ä¢ ${name} x${cart[name].count} ‚Äî ${cart[name].price * cart[name].count}‚ÇΩ\n`;
            total += cart[name].price * cart[name].count;
        }
        text += `----------\nüí∞ –ò–¢–û–ì–û: ${total}‚ÇΩ\nüì¶ –î–æ—Å—Ç–∞–≤–∫–∞: ${delivery}\nüí¨ –ö–æ–º–º–µ–Ω—Ç: ${comm || '–Ω–µ—Ç'}\n\n*–î–æ—Å—Ç–∞–≤–∫–∞ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º.*`;
        tg.sendData(text);
    }
</script>
</body>
</html>

